#!/usr/bin/env fish

set password "<password>"
set totp_secret "<otp code>"
set otp (oathtool --totp -b $totp_secret)

# Call expect inline to handle both prompts
expect -c "
  set timeout -1
  spawn ssh <email>@sshgw.aau.dk
  expect \"Password:\"
  send \"$password\r\"
  expect \"Enter Your Microsoft verification code\"
  send \"$otp\r\"
  interact
"

